# 類似投稿参考表示機能 - 使用ガイド

## 🎯 機能概要

類似投稿参考表示機能は、新しい投稿をレビューする際に、過去に判定済みの類似投稿とその判定結果を自動表示する機能です。モデレーターが一貫性のある判定を行うための参考情報を提供します。

## 🚀 アクセス方法

**URL**: http://localhost:3000/review → レビューキュー → 各投稿カードの「類似事例」アコーディオン

## 📊 主要機能

### 1. 自動類似投稿検索

- **キーワード抽出**: 投稿内容から重要なキーワードを自動抽出
- **類似度計算**: 過去の投稿とのキーワードマッチングによる類似度算出
- **結果表示**: 類似度の高い過去投稿上位3件を表示

### 2. 判定履歴表示

各類似投稿について以下の情報を表示：
- **投稿内容**: 類似投稿の内容（100文字まで）
- **AIスコア**: 当時のAI判定スコア
- **最終判定**: 人間による最終判定結果（承認/拒否）
- **判定理由**: モデレーターが記録した判定理由
- **判定日時**: 判定が行われた日時
- **作品情報**: 対象漫画のタイトル

### 3. 参考情報提供

- **検索キーワード**: 類似度計算に使用されたキーワードを表示
- **判定パターン**: 過去の類似事例の判定傾向を確認
- **一貫性確保**: 同様の投稿に対する統一した判定基準の提供

## 🔧 使用方法

### 基本的な利用手順

1. **レビューキューにアクセス**
   ```
   http://localhost:3000/review
   ```

2. **レビュー待ち投稿を選択**
   - 投稿カードが表示される
   - 「類似事例」アコーディオンが表示される

3. **類似事例を確認**
   - アコーディオンをクリックして展開
   - 類似投稿一覧が自動で読み込まれる
   - 検索キーワードと件数を確認

4. **判定の参考にする**
   - 過去の類似投稿の判定結果を参照
   - 判定理由を確認して一貫性を保つ
   - 自分の判定に活用

## 📋 表示項目の詳細

### 類似投稿カード表示内容

```
┌─────────────────────────────────────────────────────┐
│ 投稿ID: 123                    AI: 65% [承認]         │
├─────────────────────────────────────────────────────┤
│ この漫画の展開が予想できてしまいます...                 │
│                                                     │
│ 作品: 進撃の巨人                                     │
│ 判定理由: ネタバレではなく考察として判定              │
│ 判定日時: 2024-06-15 14:30:25                       │
└─────────────────────────────────────────────────────┘
```

### 状態表示

- **読み込み中**: ローディングスピナー表示
- **類似投稿あり**: 件数とキーワードを表示
- **類似投稿なし**: 「類似する過去の投稿が見つかりませんでした」メッセージ

## 💡 効果的な活用方法

### 1. 判定基準の統一

```
過去の事例を参考に同様の表現に対して一貫した判定を行う：
- ネタバレ vs 考察の境界線
- 建設的批判 vs 誹謗中傷の区別
- 軽微な問題 vs 深刻な問題の判断
```

### 2. 判定理由の参考

```
過去のモデレーターが記録した判定理由を活用：
- 承認理由のパターン学習
- 拒否理由の事例確認
- 判定ロジックの継承
```

### 3. 迷った場合の参考材料

```
判断に迷う場合の意思決定支援：
- 類似事例の判定傾向を確認
- AIスコアと人間判定の差異を分析
- 複数事例での判定パターンを把握
```

## ⚙️ 検索アルゴリズム

### キーワード抽出方法

1. **前処理**: 記号・特殊文字の除去
2. **分割**: 空白文字による単語分割
3. **フィルタリング**: 1文字以下の単語を除外
4. **選択**: 最初の5単語を検索キーワードとして使用

### 類似度計算

- **検索方式**: SQLのLIKE演算子によるキーワードマッチング
- **対象**: 承認済み・拒否済み投稿のみ
- **除外**: レビュー中の投稿本体は除外
- **制限**: 最新の3件まで表示

## 📈 活用効果

### モデレーション品質向上

- **一貫性**: 同様投稿への統一判定
- **効率性**: 判定時間の短縮
- **精度**: 過去事例に基づく適切な判断

### 学習効果

- **経験蓄積**: 判定パターンの学習
- **知識共有**: チーム内での判定基準統一
- **継続改善**: フィードバックループの形成

## ⚠️ 注意事項

### 検索結果の解釈

- **類似度**: キーワードマッチングによる簡易的な類似度
- **文脈**: 投稿の文脈や背景の違いに注意
- **判断**: 最終的な判定は現在の投稿内容に基づいて行う

### システム制限

- **データ依存**: 過去の判定データが少ない場合は結果が限定的
- **キーワード**: 短い投稿や特殊な表現では適切な検索が困難
- **更新**: リアルタイムの投稿は検索対象外

### 利用方針

- **参考情報**: 類似事例は参考材料として活用
- **独立判断**: 各投稿は個別の内容として独立して判定
- **柔軟性**: 状況に応じて過去の判定とは異なる判断も可能

## 🔧 トラブルシューティング

### よくある問題と解決方法

#### 類似投稿が表示されない

**原因**: 
- 過去の判定データが不足
- キーワードマッチングが困難な投稿内容

**解決法**:
- より多くの投稿データを蓄積
- 手動での類似投稿検索を実施

#### 読み込み時間が長い

**原因**:
- データベースの投稿数が多い
- 複雑なキーワード検索

**解決法**:
- データベースインデックスの最適化
- 検索対象期間の制限

#### 関連性の低い投稿が表示される

**原因**:
- キーワードマッチングの精度限界
- 文脈を考慮しない検索

**解決法**:
- 表示された類似投稿の関連性を個別に判断
- 複数の類似投稿を総合的に参考にする

この類似投稿参考表示機能により、モデレーターはより一貫性のある効率的な判定を行うことができ、システム全体の品質向上に貢献します。